<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kanban Board - DEBUG</title>
  <style>
    :root{
      --bg: #0f1115;
      --panel: #171a21;
      --muted: #8b95a7;
      --text: #e6e9ef;
      --accent: #7c9fff;
      --card: #1d222b;
      --border: #2a2f3a;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
      --chip-bg: #252b36;
      --danger: #ff4d4d;
      --success: #28a745;
      --warning: #f0ad4e;
      --focus: #b4ccff;
      --dashed: 4px dashed var(--border);
    }

    *{box-sizing: border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}

    /* DEBUG: Bordas coloridas para identificar elementos */
    .debug-board { border: 3px solid red; margin: 20px; padding: 20px; }
    .debug-board-content { border: 3px solid blue; padding: 10px; }
    .debug-column-headers { border: 3px solid green; padding: 10px; margin-bottom: 20px; }
    .debug-column-header { border: 2px solid yellow; padding: 5px; margin: 2px; }
    .debug-lane { border: 2px solid purple; margin: 10px 0; padding: 10px; }
    .debug-columns { border: 2px solid orange; padding: 5px; }

    /* Header */
    header{position:sticky;top:0;z-index:50;background:var(--panel);box-shadow:var(--shadow);border-bottom:1px solid var(--border)}
    .hdr{display:grid;grid-template-columns: 180px 1fr auto;gap:12px;align-items:center;padding:12px 16px;max-width:1400px;margin:0 auto}
    .title{font-weight:700;font-size:18px}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--text);cursor:pointer}
    .btn.success{background:var(--success);color:#fff;border-color:transparent}

    /* Cabeçalho das colunas - TESTE COM TABLE */
    .column-headers{
      display:table !important;
      width:100% !important;
      table-layout:fixed !important;
      background: #333 !important;
      border: 4px solid lime !important;
    }

    .column-header{
      display:table-cell !important;
      text-align:center !important;
      padding:10px !important;
      border:2px solid red !important;
      background: #555 !important;
      color: white !important;
      vertical-align:middle !important;
    }

    .column-header-title{
      font-weight:600;
      margin-bottom:4px;
      font-size:16px;
      color: lime !important;
    }

    .column-header-total{
      font-size:12px;
      color: yellow !important;
    }

    /* Lanes e Colunas */
    .lane{margin-bottom:24px}
    .lane-head{display:flex;align-items:center;gap:10px;margin-bottom:8px}
    .lane-title{font-weight:600}
    .lane-sum{color:var(--muted);font-size:12px}

    .columns{
      display:grid;
      grid-auto-flow:column;
      grid-auto-columns:minmax(240px,1fr);
      gap:12px;
    }
    
    .column{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:14px;
      min-height:140px;
      padding:10px;
    }

    /* Debug info */
    .debug-info{
      position:fixed;
      top:10px;
      right:10px;
      background:rgba(0,0,0,0.9);
      color:white;
      padding:15px;
      border-radius:8px;
      font-family:monospace;
      font-size:12px;
      max-width:300px;
      z-index:1000;
    }
  </style>
</head>
<body>
  <div class="debug-info" id="debugInfo">
    <strong>DEBUG INFO</strong><br>
    Status: <span id="status">Carregando...</span><br>
    Headers encontrados: <span id="headerCount">0</span><br>
    Colunas: <span id="columnCount">0</span><br>
    Lanes: <span id="laneCount">0</span><br>
    <button onclick="analyzeDOM()">Analisar DOM</button>
    <button onclick="toggleBorders()">Toggle Bordas</button>
  </div>

  <header>
    <div class="hdr">
      <div class="title">Kanban Board - DEBUG</div>
      <div style="flex:1"></div>
      <div class="actions">
        <button class="btn success" onclick="addColumn()">+ Coluna</button>
        <button class="btn success" onclick="addLane()">+ Lane</button>
      </div>
    </div>
  </header>

  <main class="debug-board" id="board">
    <div class="debug-board-content" id="boardContent">
      <div class="debug-column-headers" id="columnHeaders">
        <div class="debug-column-header">
          <div class="column-header-title">BCR</div>
          <div class="column-header-total">⏱ 2h</div>
        </div>
        <div class="debug-column-header">
          <div class="column-header-title">Social Insider</div>
          <div class="column-header-total">⏱ 5h</div>
        </div>
        <div class="debug-column-header">
          <div class="column-header-title">Nova coluna</div>
          <div class="column-header-total">⏱ 0m</div>
        </div>
      </div>

      <div class="debug-lane">
        <div class="lane-head">
          <div class="lane-title">Engenheiro de Dados</div>
          <div class="lane-sum">⏱ 7h</div>
        </div>
        <div class="debug-columns">
          <div class="column">
            <h4>BCR</h4>
            <p>Cards da coluna BCR</p>
          </div>
          <div class="column">
            <h4>Social Insider</h4>
            <p>Cards da coluna Social</p>
          </div>
          <div class="column">
            <h4>Nova coluna</h4>
            <p>Cards da nova coluna</p>
          </div>
        </div>
      </div>

      <div class="debug-lane">
        <div class="lane-head">
          <div class="lane-title">Arquiteto IA</div>
          <div class="lane-sum">⏱ 3h</div>
        </div>
        <div class="debug-columns">
          <div class="column">
            <h4>BCR</h4>
            <p>Cards da coluna BCR</p>
          </div>
          <div class="column">
            <h4>Social Insider</h4>
            <p>Cards da coluna Social</p>
          </div>
          <div class="column">
            <h4>Nova coluna</h4>
            <p>Cards da nova coluna</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    let bordersVisible = true;

    function updateDebugInfo() {
      const headers = document.querySelectorAll('.column-header');
      const columns = document.querySelectorAll('.column');
      const lanes = document.querySelectorAll('.debug-lane');
      
      document.getElementById('status').textContent = 'Ativo';
      document.getElementById('headerCount').textContent = headers.length;
      document.getElementById('columnCount').textContent = columns.length;
      document.getElementById('laneCount').textContent = lanes.length;
    }

    function analyzeDOM() {
      const headers = document.getElementById('columnHeaders');
      const info = {
        'Headers container': {
          display: getComputedStyle(headers).display,
          width: getComputedStyle(headers).width,
          tableLayout: getComputedStyle(headers).tableLayout
        }
      };

      document.querySelectorAll('.column-header').forEach((header, i) => {
        info[`Header ${i+1}`] = {
          display: getComputedStyle(header).display,
          width: getComputedStyle(header).width,
          textAlign: getComputedStyle(header).textAlign
        };
      });

      console.log('DOM Analysis:', info);
      alert('Análise no console - pressione F12');
    }

    function toggleBorders() {
      const elements = document.querySelectorAll('[class*="debug-"]');
      bordersVisible = !bordersVisible;
      
      elements.forEach(el => {
        if (bordersVisible) {
          el.style.border = el.className.includes('board') ? '3px solid red' :
                           el.className.includes('content') ? '3px solid blue' :
                           el.className.includes('headers') ? '3px solid green' :
                           el.className.includes('header') ? '2px solid yellow' :
                           el.className.includes('lane') ? '2px solid purple' :
                           '2px solid orange';
        } else {
          el.style.border = 'none';
        }
      });
    }

    function addColumn() {
      const headers = document.getElementById('columnHeaders');
      const newHeader = document.createElement('div');
      newHeader.className = 'debug-column-header';
      newHeader.innerHTML = `
        <div class="column-header-title">Nova Coluna ${headers.children.length + 1}</div>
        <div class="column-header-total">⏱ 0m</div>
      `;
      headers.appendChild(newHeader);

      // Adicionar coluna em cada lane
      document.querySelectorAll('.debug-columns').forEach(columns => {
        const newCol = document.createElement('div');
        newCol.className = 'column';
        newCol.innerHTML = `<h4>Nova Coluna</h4><p>Coluna adicionada</p>`;
        columns.appendChild(newCol);
      });

      updateDebugInfo();
    }

    function addLane() {
      const boardContent = document.getElementById('boardContent');
      const headerCount = document.querySelectorAll('.column-header').length;
      
      const newLane = document.createElement('div');
      newLane.className = 'debug-lane';
      
      let columnsHTML = '';
      for(let i = 0; i < headerCount; i++) {
        columnsHTML += `<div class="column"><h4>Coluna ${i+1}</h4><p>Nova lane</p></div>`;
      }
      
      newLane.innerHTML = `
        <div class="lane-head">
          <div class="lane-title">Nova Lane ${document.querySelectorAll('.debug-lane').length + 1}</div>
          <div class="lane-sum">⏱ 0h</div>
        </div>
        <div class="debug-columns">${columnsHTML}</div>
      `;
      
      boardContent.appendChild(newLane);
      updateDebugInfo();
    }

    // Inicializar
    document.addEventListener('DOMContentLoaded', () => {
      updateDebugInfo();
      
      // Aplicar CSS forçado após carregamento
      setTimeout(() => {
        const headers = document.getElementById('columnHeaders');
        headers.style.display = 'table';
        headers.style.width = '100%';
        headers.style.tableLayout = 'fixed';
        
        document.querySelectorAll('.column-header').forEach(header => {
          header.style.display = 'table-cell';
          header.style.textAlign = 'center';
          header.style.verticalAlign = 'middle';
        });
        
        console.log('CSS forçado aplicado');
        updateDebugInfo();
      }, 100);
    });
  </script>
</body>
</html>